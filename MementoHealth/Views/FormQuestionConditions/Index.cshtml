@using MementoHealth.Entities
@model IEnumerable<FormQuestionCondition>
@{
    FormQuestion formQuestion = Model.First().Question;
    ViewBag.Title = "Question Conditions";
}

<div class="text-center">
    <div class="h2 page-title font-weight-bold">@ViewBag.Title</div>
    <div class="text-secondary">
        <h5 style="margin-top: -7px">
            Question: "@formQuestion.Question"
        </h5>
        <p>
            @Html.ActionLink(" Back to Form Questions", "Index", "FormQuestions", new { id = formQuestion.FormId }, new { @class = "fa fa-arrow-circle-left text-dark" })
        </p>
    </div>
    <hr />
</div>

<div class="container" style="overflow-y: auto; white-space: nowrap; min-width: 94.5%; text-align: center">
    <ul class="text-info text-left">
        <li>Conditions will be tested during form submission in the order listed below.</li>
        <li>The form will proceed to the next ordinal question if no conditions match.</li>
    </ul>
    <div class="card shadow">
        <div class="table-responsive">
            <table class="table table-bordered table-striped">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Condition</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (FormQuestionCondition condition in Model)
                    {
                        <tr>
                            <td>@condition.Number</td>
                            <td>@condition.ToString(true)</td>
                            <td>
                                @if (condition.Number == 1)
                                {
                                    <span class="text-secondary">Up</span>
                                }
                                else
                                {
                                    using (Html.BeginForm("MoveUp", "FormQuestionConditions", new { id = condition.ConditionId }, FormMethod.Post))
                                    {
                                        @Html.AntiForgeryToken()
                                        <a href="#" onclick="this.closest('form').submit();return false;">Up</a>
                                    }
                                } |

                                @if (condition.Number == Model.Max(c => c.Number))
                                {
                                    <span class="text-secondary">Down</span>
                                }
                                else
                                {
                                    using (Html.BeginForm("MoveDown", "FormQuestionConditions", new { id = condition.ConditionId }, FormMethod.Post))
                                    {
                                        @Html.AntiForgeryToken()
                                        <a href="#" onclick="this.closest('form').submit();return false;">Down</a>
                                    }
                                } |

                                @Html.ActionLink("Insert after", "Insert", new { id = condition.ConditionId }) |
                                @Html.ActionLink("Edit", "Edit", new { id = condition.ConditionId }) |
                                @Html.ActionLink("Delete", "Delete", new { id = condition.ConditionId })
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}

@section styles {

    <style>
        form {
            display: inline-block;
        }
    </style>
}